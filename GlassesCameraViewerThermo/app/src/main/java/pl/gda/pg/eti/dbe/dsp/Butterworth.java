/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */

package pl.gda.pg.eti.dbe.dsp;

/**
 *
 * @author jwr
 */


import DSP.HammingWindow;
import DSP.HanningWindow;
import DSP.filter.iir.*;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.PrintStream;


/**
  Class to implement digital Butterworth filters.
 */
public class Butterworth extends IIRFilter {
  
  
  /**
   * Instantiates a new Butterworth digital filter.
   *
   * @param order      int specifying the order (number of poles) of the filter.
   * @param type       PassbandType specifying whether the filter is a lowpass, bandpass or highpass filter.
   * @param f1         double specifying the low cutoff frequency (must always be present, but used only for 
   *                   bandpass and highpass filters).
   * @param f2         double specifying the high cutoff frequency (must always be present, but used only for
   *                   bandpass and lowpass filters).
   * @param delta      double specifying the sampling interval of the data to which this filter will be applied.
   */
  public Butterworth( int order, PassbandType type, double f1, double f2, double delta ) {
    
    super( new AnalogButterworth( order ), type, f1, f2, delta );
      
  }

  public static  double[] padding( double []x){
    int N=x.length;
    int padding;
    if(N<=256)
 	padding=256;
    else if(N<=512)
            padding=512;
    	else if(N<=1024)
    		padding=1024;
             else	
    		padding=2048;
    double []res=new double[padding];
    System.arraycopy(x, 0, res, 0, N);
    return res;
    	 
  }
  
  public static void main( String[] args ) {
        
        double f1=3;
        double T1=1/f1;
        
        double f2=8;
        double T2=1/f2;
        
        double w1=2.0*Math.PI*f1;
        double w2=2.0*Math.PI*f2;
        
        double fs=25.0;
        double Ts=1.0/fs;
        int N=220;
        
      
        //double[] x = new double[N];
        
        //double[] x={-0.04954706477732884, -0.43105371602081277, -1.0848998698669732, -1.4556343984962439, -1.7012966310005595, -1.6451225419317552, -1.5883700838635093, -1.3407558559861172, -0.9452237565066355, -0.6723058849045742, -0.37856672932329616, 0.10400990456912496, 0.3392614950838606, 0.5581018652400189, 0.28200296414112813, -0.1415077356853658, -0.08569512724116635, -0.3626615818392054, -0.3220311596298302, -0.15452103817236207, -0.010434861191441769, 0.2478791931752653, 0.2671099624060105, 0.6212886784268505, 0.8126565211104833, 1.1462308415268865, 1.2742672787738627, 1.4875408473105836, 1.2595911654135534, 0.7869913967611524, 0.535328585887811, 0.2679052197802321, 0.10726323019088113, 0.08282713996530333, 0.1878734094852632, 0.20739336321574342, 0.26551944765762414, 0.7316848611914395, 0.7660978166570374, 1.1468092105263281, 1.2626276026605012, 1.52007410352806, 1.3926883314054521, 1.1204211249277023, 1.0031568102949677, 0.4580440283400833, 0.4160399797571017, 0.16170221226141734, 0.35307005494505006, 0.5451608588779777, 0.4691776315789582, 0.7893771688837603, 0.8668063186813129, 1.1843308993638004, 1.3621793666859503, 1.5298340803933002, 1.6982117553499165, 1.257928354540212, 1.063524074609603, 0.3172834731058458, 0.2723152834008147, -0.25132554945054153, 0.025568609022570854, 0.2614708646616464, 0.4986021544245318, 0.6508577935222775, 0.8905194476576241, 1.2170810439560569, 1.174426330248707, 1.2980527038750722, 1.503301402544821, 1.330947440717182, 1.0487756651243672, 0.6422545546558638, 0.42392025737422045, 0.3275495228455725, 0.22684102082129698, 0.23204634181607275, 0.2110804655870595, 0.299426330248707, 0.4871793666859503, 0.539015688259127, 0.7852562897628843, 0.9059908183921266, 0.9632493493348875, 0.982697006940441, 0.7041400375939872, 0.7292267929439049, 0.39948416714864265, 0.35191331694622363, 0.3242239010989181, 0.4105454742625909, 0.49903593117409173, 0.6834633458646806, 0.9986744505494585, 1.0832609167148632, 1.286774508386344, 1.386326272411793, 1.1784026171197297, 0.7882204308849055, 0.21447838345864056, 0.0654760699826511, -0.07152508675534364, -0.12827754482358955, 0.007783762290358709, 0.3461296269520062, 0.42623373337190174, 0.6177461683053878, 0.9710573308270796, 0.9242817379988537, 1.1471706911509614, 1.0914303788316886, 0.6977779786003566, 0.33188729034125686, -0.22739553209947871, -0.32362167437824496, -0.5817911364950703, -0.5655968045112729, -0.5045788750722977, -0.5008917727009816, -0.1831503036437141, 0.01284449103528118, 0.14811054077500785, 0.4922400954309012, 0.5242672787738627, 0.4487178282244031, 0.08875542220937405, -0.4224504771544275, -0.5662474696356128, -1.2346974407171842, -1.2046222527472423, -1.208598539618265, -0.9545499566223157, -0.8601312174667441, -0.7054898062463906, -0.44666967900519694, -0.21271941873914102, 0.1481828368999345, 0.24332453730480097, 0.054631651243511214, -0.05518616252169295, -0.3883990023134629, -0.7437344563331294, -1.0286534846732138, -1.0164354395604391, -0.9719733227298946, -0.8290438837478291, -0.7941971515326713, -0.44544064488141544, -0.161027689415846, -0.11331224696354525, 0.0750914545980379, 0.06084911798728854, 0.349166064198954, 0.06952465297860044, -0.092346370734532, -0.6374591526894164, -1.2367940283400856, -1.3495759832272824, -1.402569042799314, -1.5013255494505415, -1.4475372325043452, -1.4502844852515864, -0.8562995228455748, -0.8570947802197679, -0.4904088345864466, -0.38789292943897635, -0.2493735540774935, -0.46387615673799587, -0.7478553354540054, -1.0167246240601457, -1.3816031665702724, -1.4643099334875558, -1.3315742481202903, -1.272942090803923, -1.0449924089068645, -1.0721757518796835, -0.8383700838635093, -0.7368663244650122, -0.4960479323308107, -0.3974360179294365, -0.22876915847311352, -0.085767423366093, -0.1198188982070576, -0.7021641844997077, -0.9572249132446302, -1.4674186668594587, -1.4921439415847146, -1.7989686957778872, -1.554896978021958, -1.285087839791771, -1.2819791064198967, -1.0044342828224444, -0.9178235251590365, -0.4331503036437141, -0.3834105696934671, -0.10666100347020802, -0.15683451417004335, -0.6368084875650482, -0.9280895748987916};

        double []x={2.585624134319835, 2.577881659403447, 2.594146988277471, 2.661131380696646, 2.791772406337672, 3.0279318266275275, 3.36993294145473, 3.744258470997651, 4.096761258065655, 4.309475862301998, 4.333578426404559, 4.157274078578472, 3.894888348366655, 3.596421235769109, 3.3648716259586307, 3.2169563528259686, 3.13695635282597, 3.0016999425695596, 2.7768002770177214, 2.4861592513766957, 2.1438292625249677, 1.824815884598546, 1.5548214587345546, 1.334782439782491, 1.0163543461370046, 0.5728091956353307, -0.0014828890915373981, -0.6164940373635557, -1.1572911388128317, -1.473734840039142, -1.5082889091584286, -1.3076813283334572, -1.0092253640079274, -0.7051395223133887, -0.37542937738585125, -0.07657764940368794, 0.22809905070779452, 0.6710087497044492, 1.2436118712206121, 1.7499663862707782, 2.1714936995372205, 2.4941302658694395, 2.676443532313142, 2.664804736326522, 2.639520455390069, 2.6477590284112535, 2.65268099050713, 2.617028816594086, 2.700456910239571, 2.7773911354346636, 2.8418615925138146, 2.906136954832654, 3.001638627073455, 2.9549663862707782, 2.901437958177131, 2.887697712915146, 2.9340355055572878, 3.0122517820344354, 3.219353231309799, 3.4776809905071246, 3.6159307118003254, 3.6327757508192766, 3.5363766426810366, 3.305523799871671, 2.8946932536063414, 2.483617445356619, 2.0414491064491482, 1.6310756393365513, 1.2458025066721141, 0.9465494408973099, 0.6826698422351036, 0.473087902435774, 0.21859514881258635, 0.029024357285275082, -0.06412502955976265, -0.08321644539030784, 0.02249704401883379, 0.33643795817713906, 0.6352896861593, 0.8039964866052298, 0.8618448701057867, 0.81254721124291, 0.5891302658694428, 0.3138181142529436, 0.11958177088616595, 0.008132495523847181, -0.10072480659432359, -0.1370793216444906, -0.03685635620413337, 0.13622614100879787, 0.35916928482150634, 0.6578983818114716, 0.9628705111314264, 1.0532662747880592, 0.953600722948595, 0.6532272558359977, 0.2257356170400123, -0.2848775379209678, -0.5641417519677896, -0.6946211276645556, -0.6433446505185122, -0.46550741528997264, -0.22634353569131008, -0.1120012837403624, -0.009007972703574299, 0.18877352116487484, 0.4138627073410168, 0.709492584710024, 1.0501391844870578, 1.4321012803621977, 1.598193811019946, 1.6420734096821537, 1.6008638221682177, 1.5647155501503802, 1.447580656058964, 1.4094033985338796, 1.352998716259632, 1.1989909124692202, 0.9767947028817071, 0.6739295969731234, 0.30974342083042533, -0.05748623357314157, -0.29523985676154785, -0.4647995000168441, -0.37453751562442567, -0.07046282220190622, 0.3894758623019948, 0.8811146582886158, 1.404347657173788, 1.7089463193811458, 1.7601782034391171, 1.7445371777980916, 1.6747545691024404, 1.475629708455841, 1.3011425289686622, 1.2340020607412374, 1.1313041789129203, 1.0570845579541686, 1.1206018377757958, 1.2619284821459178, 1.4124245802507107, 1.599676531198314, 1.7526085267390055, 1.735663153271893, 1.6113710685450258, 1.4401726293031094, 1.1302952602953051, 0.7950722948549493, 0.5991692848215053, 0.4398883483666566, 0.3142306003176043, 0.3474413026587422, 0.4180934765717848, 0.46489392250266404, 0.588834836660967, 0.666465828857174, 0.6999998310868263, 0.6904624843755653, 0.6355683929597343, 0.45939225026185343, 0.2949831086788003, 0.0681157731158146, -0.1724416404850763, -0.44715735954862, -0.7143256984560888, -1.051114996114951, -1.425390358433791, -1.84626549778719, -2.344810648288861, -2.902943312725872, -3.466873078612159, -4.001009087530777, -4.475206411945491, -4.740853011722526, -4.833188574710262, -4.717319009492871, -4.453255464342371, -4.012809533461658, -3.5453736360257615, -3.0410146616667895, -2.5918619303401464, -2.228645653863001, -2.010652342826213, -1.8813156650112752, -1.844554238032456, -1.8244037363602146, -1.7328039593256552, -1.5623245836288866, -1.3167281510759312, -1.008194148846277, -0.6857303807303355, -0.3933167798384738, -0.1853067463936588, -0.08670028039588942, -0.0626200128373614, -0.12183963379611214, -0.30374041417515396, -0.5572576939967814, -0.8796378500725893, -1.2485285970068138, -1.6566947062598796, -1.98282068173368, -2.218461707374704, -2.303662376271024, -2.32384074862331, -2.195462822201904, -2.010847437586519, -1.7340692881996755, -1.4676980507414827, -1.1345375156244268, -0.8524304922130579, -0.5467838924360251, -0.3199277051450554, -0.10136583223535581, 0.03206226141012962, 0.17910796932540504, 0.2246319381102455, 0.22334988682819584, 0.20375122462083936, 0.23372335394079524, 0.2614992736732359, 0.36656616330534125, 0.5492863416776913, 0.7842473227256267, 1.0467278132495939, 1.330819229080139, 1.596928482145913, 1.8576363974190464, 2.027441302658734, 2.0627701766832605, 2.0659028411202724, 2.0135505557245086, 1.8774580250667596, 1.7606352825918439, 1.7136174453566162, 1.5566832201615228, 1.4211926961927392, 1.3455572446877238, 1.307168169994302, 1.3242306003176032, 1.440980879024404, 1.4910979358805911, 1.4350667207189418, 1.2693030640857192, 0.9663487720009915, 0.6047601432384488, 0.27563528259184866, 0.02725735617044277, -0.11403584338362634, -0.15599236512275752, -0.1253569136177407, -0.01959883112052809, 0.11806003175572641, 0.18789280767545846, 0.28075791358404334, 0.3794033985338751, 0.4759474342083444, 0.5868448701057798, 0.8187512246208304, 1.0434613695483665, 1.2788571332050016, 1.5245427519341013, 1.775033275902888, 1.9875695077869466, 2.168528259180481, 2.2674747474747945, 2.265022127630869, 2.163210533427971, 1.982379987162642, 1.7684892402284174, 1.5955962636397896, 1.4838571332050072, 1.4230711800277493, 1.388243978244026, 1.4058749704402351, 1.4394758623019959, 1.4934892402284174, 1.648801391844917, 1.9079485490355523, 2.167485895746812, 2.4246653829262983, 2.5690856727813696, 2.4924022837066753, 2.208684334988725, 1.850189351711132, 1.5058080808081218, 1.3538013918449108, 1.4055739670957472, 1.6293030640857147, 2.0050722948549455, 2.3449886828148125, 2.5418838890578455, 2.6041358400054495, 2.595919563528303, 2.392686564643131, 2.122184892402328, 1.8155851153677667, 1.5197322725584015, 1.196828147697754, 1.003678760852714, 0.9181046248437952, 0.93277575081927, 1.03361187122061, 1.193595148812585, 1.306839295969778, 1.3967724063376727, 1.4720455390021108, 1.472881659403448, 1.4479652714435813, 1.4553565757914066, 1.4496040674302013, 1.437168169994302, 1.506588459849373, 1.6207077463599628, 1.720189351711132, 1.8177924732272959, 1.8911759737847103, 1.919721124286383, 1.959063376237332, 2.0849440897267426, 2.310456910239565, 2.5922071889463654, 2.8332105334279705, 2.9615884598493745, 2.954682105334323, 2.885757913584043, 2.7802952602953033, 2.7144312692139216, 2.775596263639787, 2.9408192290801454, 3.063466943684383, 3.219921793182711, 3.443282997196087, 3.595752339448037, 3.6091469882774683, 3.568288571332095, 3.439682105334325, 3.1749106449106916, 2.8780210128036687, 2.6560756393365543, 2.467485895746811, 2.3123075233945243, 2.2355293740076787, 2.2109976014324286, 2.19352268504447, 2.2519340562819283, 2.3691915813655404, 2.5197378466944156, 2.7107913584001, 2.988528259180479, 3.248862707341013, 3.491777980473679, 3.6725973784669903, 3.6816330529374484, 3.462987567987617, 3.100066720718945, 2.6478649369954224, 2.167881659403449, 1.8246932536063478, 1.647658693963093, 1.5904680585115876, 1.5593532313098035, 1.5798604776866134, 1.6201280362150405, 1.6541469882774695, 1.7410589169285278, 1.8848103104625284, 1.982301949258515, 2.0120343907300855, 1.9922016148103523, 1.8675026181548344, 1.662346542346586, 1.4513320495929634, 1.2353677240634227, 1.1099552379987643, 1.126660923617494, 1.2898939225026675, 1.5973632647546199, 1.8671124286342184, 1.8539017262930817, 1.4361648255127022, 0.6003621499274174, -0.6872521198607672, -2.047921016181839, -3.244832944832899, -4.084570960440481, -4.469364717408152, -4.345234282625543, -3.88318857471027, -3.196661261443826, -2.490490692881952, -1.899236512279946, -1.5038518968953303, -1.371811763116066, -1.4458251410424872, -1.5529990540859662, -1.5946657207526325, -1.553054795446054, -1.4332443160703565, -1.283400391878605, -1.158879767575371, -1.0962097564270983, -1.0289856761595388, -0.9290135468395828, -0.7889745278875193, -0.6355408601060242, -0.49789314550178687, -0.4596601466166135, -0.5021629336846183, -0.6243034019120444, -0.8108307151784903, -0.9822688422687929, -1.0809867909867443, -1.0924193439410375, -0.9632331677983406, -0.7135174487347945, -0.5055966014661214, -0.3230436471740359, -0.21363450559098168, -0.2853067463936577, -0.5325196783891999, -0.7670570251004596, -1.0542253640079289, -1.3824973818451634, -1.6595653863044706, -1.8516556873078138, -2.02821644539031, -2.124543089760433, -2.075055910273253, -1.9069678389243119, -1.6522465457247588, -1.3659366237626638, -1.0826980507414816, -0.8274750853011256, -0.5848440931049163, -0.3966110942197429, -0.1590246951116046, 0.14112580656063528, 0.4080656058917384, 0.5898716259586274, 0.8190466538293071, 0.9761425289686609, 1.0269229080099103, 1.0496765311983167, 1.0953064085673248, 1.0296542346542812, 0.9187623728928545, 0.8239017262930781, 0.7116720718895112, 0.6125862301949747, 0.5768448701057889, 0.6193922502618647, 0.6750945913989882, 0.7854624843755766, 0.8589128745650966, 0.9128426404513833, 0.9545594743421292, 0.970557244687725, 0.9308080808081263, 0.8841915813655408, 0.8335728522685519, 0.7694981588460337, 0.7967222391135931, 0.910847099760192, 1.103751224620837, 1.3531659403398986, 1.5887567987568423, 1.6965048478092377, 1.6997657173744554, 1.575429039559517, 1.2998772000946348, 0.91831086787613, 0.5210310462484836, 0.1466664977535004, -0.1718006148440463, -0.3999165568730302, -0.540552008378046, -0.6246657207526265, -0.7008474375865159, -0.7698496672409191, -0.8174862335731381, -0.8100224654571969, -0.7693758656801639, -0.7124527887570877, -0.630462822201904, -0.565462822201904, -0.5479210161818366, -0.580189689537466, -0.6163937029153932, -0.687268842268794, -0.7580770919900885, -0.8352175602175145, -0.8926590317894215, -0.9758028444984518, -1.0558641599945509, -1.1652454308975608, -1.280061484409267, -1.4098663896489552, -1.5288518968953313, -1.6230826661260995, -1.6407749738184065, -1.636744873483957, -1.5912376271071447, -1.4792309381439337, -1.3529321644538561, -1.1993702915441566, -0.9648496672409237, -0.6886010607749267, -0.4331216850781595, -0.18004476200123576, -0.05098121685073352, -0.006321239147276855, -0.009275531232002542, 0.00863974190066188, 0.06750819229085095, 0.26081365494413833, 0.49441454680589914, 0.7672573561704473, 1.0103844464714509, 1.182792473227304, 1.2802060741191668, 1.3694479916219542, 1.3762038444647635, 1.3547991621905169, 1.342173744130316, 1.2459362859363363, 1.0755460964157124, 0.8906185601838276, 0.6695093071180509, 0.39657731157735837, 0.22816036620389016, 0.1053565757914032, 0.054877200094637146, 0.05753048883488304, 0.14769771291515213, 0.2575137664268584, 0.44027853788728183, 0.6987345022128102, 1.035183777575129, 1.4235449815885055, 1.8232105334279693, 2.0874078578426865, 2.1956854498159304, 2.201493699537224, 2.0857077463599674, 1.9063933650890648, 1.8419563528259641, 1.8223353940745697, 1.7700054052228407, 1.7432774230600738, 1.7144312692139192, 1.6030600317557262, 1.5037066315327627, 1.4311815479207246, 1.3101503327590762, 1.1150444241749073, 0.9419396304179385, 0.7441860072295299, 0.588322016148145, 0.532686564643127, 0.6009195635282992, 0.6890522279653123, 0.8294201209419032, 0.9549552379987618, 1.0259530083443598, 1.050997601432433, 1.000852673896203, 0.8924580250667725, 0.7638292625249664, 0.6246096415662157, 0.4439240228371181, 0.3043588054458132, 0.14713472517825382, -0.0317615958919805, -0.21314955575820252, -0.37305479544605197, -0.5027537921015721, -0.6120625992364671, -0.7245319414884193, -0.8647549069287767, -1.0118396337961122, -1.2847047397046958, -1.601449444275488, -1.9147604810647862, -2.204225364007931, -2.4693256984560925, -2.5436345055909877, -2.472625586973372, -2.274531941488422, -1.9421852302286653, -1.5350559102732564, -1.09749738184516, -0.7010369582108217, -0.3897772034728041, -0.22912502955976038, -0.13227999054080897, -0.154977872369127, -0.25967686902464726, -0.41178389243602165, -0.547084895780505, -0.7484394108306731, -0.9741138812877533, -1.190206411945502, -1.3985508935508517, -1.570083780953304, -1.6518953751562016, -1.7149332792810608, -1.715106077497336, -1.6366501131718063, -1.5346935914326754, -1.4372521198607697, -1.2605687307860776, -1.0580770919900908, -0.8463992770514063, -0.6292532346879728, -0.38904699165564127, -0.17941488463222752, -0.0014327218674554886, 0.1312094186007721, 0.2401280362150419, 0.32293182662752656, 0.37166092361749065, 0.45289280767546075, 0.5439797641971995, 0.7014936995372215, 0.9425081922908453, 1.3597545691024413, 1.811839295969778, 2.346499273673235, 2.834135840005454, 3.170172629303112, 3.227892807675463, 3.1148381811425736, 2.8235951488125837, 2.3829708455795844, 1.9063153271849367, 1.4536899091247357, 0.9637567987568447, 0.46945913989396904, 0.03493851559073733, -0.33734688017291886, -0.6190804364716916, -0.7526423093813912, -0.7744817742643352, -0.7206411945541913, -0.5859867909867456, -0.49125992365118354, -0.5256021756021312, -0.7046935914326775, -0.9779265903178509, -1.4189968244315627, -1.8280102023579843, -2.0754293773858548, -2.136928819972253, -2.0645096449443803, -1.8150001689131634, -1.4847772034728055, -1.1346768690246438, -0.7796211276645533, -0.4469622647882988, -0.18420864159989375, -0.05964342420858999, -0.062224249180720795, -0.18332792811048876, -0.3581830005742586, -0.5366947062598786, -0.6339355089354649, -0.6739522313434907, -0.65560217560213, -0.6326701800614388, -0.6036623762710258, -0.6006356204181827, -0.5994929225363558, -0.6015107597715849, -0.5699667240971145, -0.5322298233167351, -0.506566501131673, -0.5024137698050277, -0.5067392993479473, -0.5443814398161737, -0.5780826661260949, -0.550747103138358, -0.4994706259923146, -0.4825977162933179, -0.4496935914326718, -0.42096449444270656, -0.43659437181171484, -0.4795821087124966, -0.4980659437180714, -0.47075267727437103, -0.37646059254750414, -0.2393647174081514, -0.05497229823312409, 0.17928076754168049, 0.35047363264759046, 0.3534780919563992, 0.260245093071228, 0.16350038850043805, 0.003177088611921575, -0.15301020235797863, -0.1654516739298856, -0.09404141751963038, -0.08987753792096896, -0.10179504070803773, -0.15386304516734756, -0.3289076382554197, -0.6029154420458326, -0.8804182291138375, -1.1536568021350195, -1.4194539035842948, -1.6664661666835137, -1.939777203472811, -2.2967170028039137, -2.7439968244315605, -3.252096044052517, -3.8130826661260953, -4.334275531232002, -4.765055910273251, -5.079476200128324, -5.261527482179607, -5.25874598831116, -5.090897604810605, -4.75325546434238, -4.297525252525213, -3.8132275936623374, -3.3832275936623377, -3.0529265903178553, -2.8678374041417127, -2.779275531232013, -2.6993647174081548, -2.5666389648997927, -2.4479488868618873, -2.287475085301129, -2.1355743049220868, -2.069392588088195, -2.0965776494036903, -2.0758753082665646, -2.090702510050287, -2.117084895780498, -2.034766055200787, -1.895724806594321, -1.7490525657916465, -1.5856913617782689, -1.382859700685738, -1.2122298233167306, -1.0801841154014573, -1.018411540150622, -0.9335843383668987, -0.8669734130603219, -0.9360258099388055, -1.0581161109421497, -1.189225364007923, -1.3117392993479449, -1.4610035133947679, -1.4558920306745893, -1.4091083071517356, -1.372268842268794, -1.4717615958919827, -1.5516501131718041, -1.6877537921015708, -1.7615274821796092, -1.7482443160703565, -1.6309421978986745, -1.5933892436065913, -1.6296824431606605, -1.7797158879767139, -2.090083780953303, -2.480262153305587, -2.8794204587682386, -3.2929656092699098, -3.6722131009087042, -3.9342420864159515, -4.06625992365118, -4.058205297118294, -3.8662766460592097, -3.5696044052565354, -3.191421573595444, -2.8664494442754895, -2.5685843383669043, -2.3279433127258775, -2.16776494037359, -2.110853011722529, -2.113049221310041, -2.201962264788301, -2.375490692881947, -2.6090581399276567, -2.8201618188574242, -2.9275531232052527, -2.9288463227593224, -2.8707693996824, -2.711527482179613, -2.5794316070402594, -2.530200837809489, -2.5525419749332343, -2.6281384074861878, -2.7695040708083716, -2.9311261443869663, -3.1151506705854035, -3.360724806594321, -3.6296880172966626, -3.9240246951116005, -4.278896489983394, -4.629191919191868, -4.962714773149504, -5.262374750852959, -5.514782777608812, -5.562469511165112, -5.487999054085959, -5.247859700685735, -4.920591027330106, -4.571209756427096, -4.371282220195212, -4.230747103138356, -4.152112766460541, -4.077514104253184, -3.918333502246495, -3.6204795446099296, -3.370368061889752, -3.183205297118292, -3.0448440931049143, -3.0274695111651146, -3.1271740819566425, -3.1922967129488393, -3.2087013952230867, -3.2087013952230867};

        N=x.length;
        /*
        for(int i=0;i<x.length;i++){
            x[i]=Math.sin(w1*i*Ts)+Math.sin(w2*i*Ts);
        }
        */
        //HammingWindow hw=new HammingWindow(N);
        HanningWindow hw=new HanningWindow(N);
        double []xw=new double[N];
        
        
        //hw.window(x, 0, xw);
        
        double []x_padd=padding(x);
        double[] y = new double[ x_padd.length ];
        
        //Butterworth B = new Butterworth( 5, PassbandType.BANDPASS, 0.6, 3.6, Ts );
        
        //Butterworth B = new Butterworth( 5, PassbandType.BANDPASS, 0.1, 0.8, Ts );
        //Butterworth B = new Butterworth( 4, PassbandType.HIGHPASS, 0.100, 0.8, Ts );
        Butterworth B = new Butterworth( 4, PassbandType.BANDPASS, 0.125, 0.5, Ts );
        B.print( System.out );
        
        B.filter( x_padd, y );
        
        Spectrum spectrum = new Spectrum(y,fs);        
        //new Plot("Spectrum", spectrum.getF(),spectrum.getFreqResponse(), "f, Hz", "S, dB");
        /*
        B.print( System.out );
        double[] tmp = new double[201];
        for ( int i = 0;  i < 201;  i++ ) {
                Complex C = B.evaluate( Math.PI/200.0*i );
                tmp[i] = (double) Complex.abs( C );
        }
                */
        
        
        //x[200] = 1.0f;
        
        /*
        for(int l=0;l<y.length;l++){
            y[l]=-y[l];
        }
        */
        
        double [][] res=new double[3][y.length];
        res[0]=x;
        res[1]=xw;
        res[2]=y;
        //new MultiPlot("res",res);
        
        /*
        PrintStream ps;
        try {
                ps = new PrintStream( System.out);
                ps.print( "R = [ " );
                for ( int i = 0;  i < 200;  i++ ) {
                        ps.println( tmp[i] + "; ..." );
                }
                ps.println( tmp[200] + "];" );
                ps.close();
        } catch (Exception e) {
                e.printStackTrace();
        }
        
        try {
                ps = new PrintStream( System.out );
                ps.print( "IR = [ " );
                for ( int i = 0;  i < 1000;  i++ ) {
                        ps.println( y[i] + "; ..." );
                }
                ps.println( y[1000] + "];" );
                ps.close();
        } catch (Exception e) {
                e.printStackTrace();
        }

                */
  }
  
}

